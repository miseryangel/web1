"use strict";var __extends=this&&this.__extends||function(){var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();exports.__esModule=!0,exports.BTree=exports.TrieTree=exports.SplayTree=exports.SegmentTree=exports.RedBlackTree=exports.AVLTree=exports.BSTree=exports.Tree=void 0;var node_1=require("./node"),symbol_1=require("./symbol"),Tree=function(){function e(){this.root=null}return e.prototype.addHelper=function(e,t){return null===e?null:e.val>t?null===e.left?e:this.addHelper(e.left,t):null===e.right?e:this.addHelper(e.right,t)},e.prototype.dfs=function(e,t){return null===t?null:t.val>e?this.dfs(e,t.left):t.val===e?t:this.dfs(e,t.right)},e}(),BSTree=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.addNode=function(e){var t=this.addHelper(this.root,e);null===t?this.root=new node_1.TreeNode(e,null,symbol_1.ROOT):t.val>e?t.left=new node_1.TreeNode(e,t,symbol_1.LEFT):t.right=new node_1.TreeNode(e,t,symbol_1.RIGHT)},t.prototype.deleteNode=function(e){var t=this.dfs(e,this.root);if(null!==t)if(null===t.left&&null===t.right)switch(t.parentSide){case symbol_1.LEFT:t.parent.left=null;break;case symbol_1.RIGHT:t.parent.right=null;break;case symbol_1.ROOT:this.root=null}else if(null===t.left)switch(t.right.parentSide=t.parentSide,t.right.parent=t.parent,t.parentSide){case symbol_1.LEFT:t.parent.left=t.right;break;case symbol_1.RIGHT:t.parent.right=t.right;break;case symbol_1.ROOT:this.root=t.right}else if(null===t.right)switch(t.left.parentSide=t.parentSide,t.left.parent=t.parent,t.parentSide){case symbol_1.LEFT:t.parent.left=t.left;break;case symbol_1.RIGHT:t.parent.right=t.left;break;case symbol_1.ROOT:this.root=t.left}else{for(var r=t.left,l=t.right,n=0,i=0;null!==r.right;)r=r.right,n++;for(;null!==l.left;)l=l.left,i++;i<=n?(t.val=r.val,r.parentSide===symbol_1.LEFT?(t.left=r.left,null!==t.left&&(t.left.parent=t)):(r.parent.right=r.left,null!==r.left&&(r.left.parent=r.parent,r.left.parentSide=symbol_1.RIGHT))):(t.val=l.val,l.parentSide===symbol_1.RIGHT?(t.right=l.right,null!==t.right&&(t.right.parent=t)):(l.parent.left=l.right,null!==l.right&&(l.right.parent=l.parent,l.right.parentSide=symbol_1.LEFT)))}},t}(exports.Tree=Tree);exports.BSTree=BSTree;var AVLTree=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.addNode=function(e){var t=this.addHelper(this.root,e);null===t?this.root=new node_1.AVLNode(e,null,0,0,symbol_1.ROOT):t.val>e?t.left=new node_1.AVLNode(e,t,0,0,symbol_1.LEFT):t.right=new node_1.AVLNode(e,t,0,0,symbol_1.RIGHT),this.update(t)},t.prototype.deleteNode=function(e){var t=this.dfs(e,this.root);if(null!==t){if(null===t.left&&null===t.right){switch(t.parentSide){case symbol_1.LEFT:t.parent.left=null;break;case symbol_1.RIGHT:t.parent.right=null;break;case symbol_1.ROOT:this.root=null}t=t.parent}else if(null===t.left){switch(t.right.parentSide=t.parentSide,t.right.parent=t.parent,t.parentSide){case symbol_1.LEFT:t.parent.left=t.right;break;case symbol_1.RIGHT:t.parent.right=t.right;break;case symbol_1.ROOT:this.root=t.right}t=t.parent}else if(null===t.right){switch(t.left.parentSide=t.parentSide,t.left.parent=t.parent,t.parentSide){case symbol_1.LEFT:t.parent.left=t.left;break;case symbol_1.RIGHT:t.parent.right=t.left;break;case symbol_1.ROOT:this.root=t.left}t=t.parent}else{for(var r=t.left,l=t.right,n=0,i=0;null!==r.right;)r=r.right,n++;for(;null!==l.left;)l=l.left,i++;i<=n?(t.val=r.val,r.parentSide===symbol_1.LEFT?(t.left=r.left,null!==t.left&&(t.left.parent=t)):(r.parent.right=r.left,null!==r.left&&(r.left.parent=r.parent,r.left.parentSide=symbol_1.RIGHT),t=r.parent)):(t.val=l.val,l.parentSide===symbol_1.RIGHT?(t.right=l.right,null!==t.right&&(t.right.parent=t)):(l.parent.left=l.right,null!==l.right&&(l.right.parent=l.parent,l.right.parentSide=symbol_1.LEFT),t=l.parent))}this.update(t)}},t.prototype.update=function(e){null!==e&&(e.ld=null===e.left?0:1+Math.max(e.left.ld,e.left.rd),e.rd=null===e.right?0:1+Math.max(e.right.ld,e.right.rd),e.ld>e.rd+1?e.left.ld>e.left.rd?this.rotation(e,e.left,e.left.left,0):this.rotation(e,e.left,e.left.right,1):e.rd>e.ld+1&&(e.right.rd>e.right.ld?this.rotation(e,e.right,e.right.right,2):this.rotation(e,e.right,e.right.left,3)),null!==e.parent?this.update(e.parent):this.root=e)},t.prototype.rotation=function(e,t,r,l){switch(l){case 0:t.parent=e.parent,t.parentSide=e.parentSide,null!==t.parent&&(t.parentSide===symbol_1.LEFT?t.parent.left=t:t.parent.right=t),e.left=t.right,null!==e.left?((e.left.parent=e).left.parentSide=symbol_1.LEFT,e.ld=1+Math.max(e.left.ld,e.left.rd)):e.ld=0,e.parent=t,e.parentSide=symbol_1.RIGHT,t.right=e;break;case 1:t.right=r.left,null!==t.right?((t.right.parent=t).right.parentSide=symbol_1.RIGHT,t.rd=1+Math.max(t.right.ld,t.right.rd)):t.rd=0,e.left=r.right,null!==e.left?((e.left.parent=e).left.parentSide=symbol_1.LEFT,e.ld=1+Math.max(e.left.ld,e.left.rd)):e.ld=0,r.parent=e.parent,r.parentSide=e.parentSide,null!==r.parent&&(r.parentSide===symbol_1.LEFT?r.parent.left=r:r.parent.right=r),t.parent=r,e.parent=r,e.parentSide=symbol_1.RIGHT,r.left=t,r.right=e;break;case 2:t.parent=e.parent,t.parentSide=e.parentSide,null!==t.parent&&(t.parentSide===symbol_1.LEFT?t.parent.left=t:t.parent.right=t),e.right=t.left,null!==e.right?((e.right.parent=e).right.parentSide=symbol_1.RIGHT,e.rd=1+Math.max(e.right.rd,e.right.ld)):e.rd=0,e.parent=t,e.parentSide=symbol_1.LEFT,t.left=e;break;case 3:t.left=r.right,null!==t.left?((t.left.parent=t).left.parentSide=symbol_1.LEFT,t.ld=1+Math.max(t.left.ld,t.left.rd)):t.ld=0,e.right=r.left,null!==e.right?((e.right.parent=e).right.parentSide=symbol_1.RIGHT,e.rd=1+Math.max(e.right.ld,e.right.rd)):e.rd=0,r.parent=e.parent,r.parentSide=e.parentSide,null!==r.parent&&(r.parentSide===symbol_1.LEFT?r.parent.left=r:r.parent.right=r),e.parent=r,e.parentSide=symbol_1.LEFT,(t.parent=r).left=e,r.right=t}},t}(Tree);exports.AVLTree=AVLTree;var RedBlackTree=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.addNode=function(e){var t=this.addHelper(this.root,e),r=new node_1.RedBlackNode(e,t,symbol_1.ROOT,symbol_1.RED);null===t?(this.root=r).color=symbol_1.BLACK:t.val>e?(t.left=r).parentSide=symbol_1.LEFT:(t.right=r).parentSide=symbol_1.RIGHT,this.insertRotate(r)},t.prototype.insertRotate=function(e){for(;null!==e.parent&&e.parent.color===symbol_1.RED;){var t=e.parent.parent,r=e.parent,l=e.parent.color===symbol_1.LEFT?t.right:t.left;null!==l&&l.color===symbol_1.RED?(l.color=symbol_1.BLACK,r.color=symbol_1.BLACK,t.color=symbol_1.RED,e=t):r.parentSide===symbol_1.LEFT&&e.parentSide===symbol_1.RIGHT?(e.parent=t,e.parentSide=symbol_1.LEFT,t.left=e,r.parent=e,r.right=e.left,null!==r.right&&((r.right.parent=r).right.parentSide=symbol_1.RIGHT),e.left=r,e=r):r.parentSide===symbol_1.RIGHT&&e.parentSide===symbol_1.LEFT?(e.parent=t,e.parentSide=symbol_1.RIGHT,t.right=e,r.parent=e,r.left=e.right,null!==r.left&&((r.left.parent=r).left.parentSide=symbol_1.LEFT),e.right=r,e=r):r.parentSide===symbol_1.LEFT&&e.parentSide===symbol_1.LEFT?(r.parent=t.parent,r.parentSide=t.parentSide,null!==r.parent&&(r.parentSide===symbol_1.LEFT?r.parent.left=r:r.parent.right=r),r.color=symbol_1.BLACK,t.left=r.right,null!==t.left&&((t.left.parent=t).left.parentSide=symbol_1.LEFT),(r.right=t).parent=r,t.color=symbol_1.RED,t.parentSide=symbol_1.RIGHT):(r.parent=t.parent,r.parentSide=t.parentSide,null!==r.parent&&(r.parentSide===symbol_1.LEFT?r.parent.left=r:r.parent.right=r),r.color=symbol_1.BLACK,t.right=r.left,null!==t.right&&((t.right.parent=t).right.parentSide=symbol_1.RIGHT),(r.left=t).parent=r,t.color=symbol_1.RED,t.parentSide=symbol_1.LEFT)}null!==e.parent&&null===e.parent.parent&&(this.root=e.parent),this.root.color=symbol_1.BLACK},t.prototype.deleteNode=function(e){var t=this.dfs(e,this.root);if(null!==t){t.color;if(null===t.left&&null===t.right)switch(t.parentSide){case symbol_1.LEFT:t.parent.left=null;break;case symbol_1.RIGHT:t.parent.right=null;break;case symbol_1.ROOT:this.root=null}else if(null===t.left)switch(t.right.parentSide=t.parentSide,t.right.parent=t.parent,t.parentSide){case symbol_1.LEFT:t.parent.left=t.right;break;case symbol_1.RIGHT:t.parent.right=t.right;break;case symbol_1.ROOT:this.root=t.right}else if(null===t.right)switch(t.left.parentSide=t.parentSide,t.left.parent=t.parent,t.parentSide){case symbol_1.LEFT:t.parent.left=t.left;break;case symbol_1.RIGHT:t.parent.right=t.left;break;case symbol_1.ROOT:this.root=t.left}else{for(var r=t.left,l=t.right,n=0,i=0;null!==r.right;)r=r.right,n++;for(;null!==l.left;)l=l.left,i++;i<=n?r.color:l.color,i<=n?(t.val=r.val,r.parentSide===symbol_1.LEFT?(t.left=r.left,null!==t.left&&(t.left.parent=t)):(r.parent.right=r.left,null!==r.left&&(r.left.parent=r.parent,r.left.parentSide=symbol_1.RIGHT),t=r.parent)):(t.val=l.val,l.parentSide===symbol_1.RIGHT?(t.right=l.right,null!==t.right&&(t.right.parent=t)):(l.parent.left=l.right,null!==l.right&&(l.right.parent=l.parent,l.right.parentSide=symbol_1.LEFT),t=l.parent))}}},t}(Tree);exports.RedBlackTree=RedBlackTree;var SegmentTree=function(l){function e(e,t){var r=l.call(this)||this;return r.data=e,r.len=t,r.root=r.generator(e,0,t-1),r}return __extends(e,l),e.prototype.generator=function(e,t,r){if(t===r)return new node_1.SegmentNode(e[t],null,symbol_1.ROOT,{low:t,up:t});var l=t+Math.floor((r-t)/2),n=this.generator(e,t,l),i=this.generator(e,l+1,r),a=new node_1.SegmentNode(n.val+i.val,null,symbol_1.ROOT,{low:t,up:t});return n.parent=a,n.parentSide=symbol_1.LEFT,i.parent=a,i.parentSide=symbol_1.RIGHT,a.left=n,a.right=i,a},e.prototype.update=function(e){var t,r;null!==e&&(t=null===e.left?0:e.left.val,r=null===e.right?0:e.right.val,e.val=t+r)},e.prototype.changeVal=function(e,t){this.data[e]=t;for(var r=this.root;r.span.low!==r.span.up;)r=null!==r.left&&r.left.span.up>=e?r.left:r.right;return r.val=t,r},e}(Tree);exports.SegmentTree=SegmentTree;var SplayTree=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.splay=function(e){if(null!==e.parent){if(null===e.parent.parent){var t=e.parent;return e.parentSide===symbol_1.LEFT?(t.left=e.right,null!==t.left&&((t.left.parent=t).left.parentSide=symbol_1.LEFT),(e.right=t).parentSide=symbol_1.RIGHT):(t.right=e.left,null!==t.right&&((t.right.parent=t).right.parentSide=symbol_1.RIGHT),(e.left=t).parentSide=symbol_1.LEFT),(t.parent=e).parent=null,e.parentSide=symbol_1.ROOT,void(this.root=e)}var r=e.parent,l=e.parent.parent,n=e.parentSide,i=r.parentSide;e.parent=l.parent,e.parentSide=l.parentSide,null!==e.parent&&(e.parentSide===symbol_1.LEFT?e.parent.left=e:e.parent.right=e),n===i?(n===symbol_1.LEFT?(r.left=e.right,null!==r.left&&((r.left.parent=r).left.parentSide=symbol_1.LEFT),l.left=r.right,null!==l.left&&((l.left.parent=l).left.parentSide=symbol_1.LEFT),(e.right=r).parentSide=symbol_1.RIGHT,(r.right=l).parentSide=symbol_1.RIGHT):(r.right=e.left,null!==r.right&&((r.right.parent=r).right.parentSide=symbol_1.RIGHT),l.right=r.left,null!==l.right&&((l.right.parent=l).right.parentSide=symbol_1.RIGHT),(e.left=r).parentSide=symbol_1.LEFT,(r.left=l).parentSide=symbol_1.LEFT),(l.parent=r).parent=e):(n===symbol_1.RIGHT?(l.left=e.right,null!==l.left&&((l.left.parent=l).left.parentSide=symbol_1.LEFT),r.right=e.left,null!==r.right&&((r.right.parent=r).right.parentSide=symbol_1.RIGHT),e.left=r,(e.right=l).parentSide=symbol_1.RIGHT):(l.right=e.left,null!==l.right&&((l.right.parent=l).right.parentSide=symbol_1.RIGHT),r.left=e.right,null!==r.left&&((r.left.parent=r).left.parentSide=symbol_1.LEFT),e.right=r,(e.left=l).parentSide=symbol_1.LEFT),r.parent=e,l.parent=e),this.splay(e)}else this.root=e},t.prototype.delete=function(e){var t,r,l;this.splay(e),null===e.left&&null===e.right?this.root=null:null===e.left?(this.root=e.right,this.root.parent=null,this.root.parentSide=symbol_1.ROOT):(t=e.right,r=e.left,l=this.findMax(r),e.left.parent=null,e.left.parentSide=symbol_1.ROOT,this.root=e.left,this.splay(l),null!==(l.right=t)&&(t.parent=l))},t.prototype.findMax=function(e){return null!==e.right&&(e=e.right),e},t}(Tree);exports.SplayTree=SplayTree;var TrieTree=function(e){this.root=e,this.nodes=new Array(7).fill(0)};exports.TrieTree=TrieTree;var BTree=function(){function e(e){this.root=null,this.Order=e}return e.prototype.split=function(e){if(!(e.keys.length<this.Order)){var t=e.children,r=e.keys,l=e.isLeaf,n=e.parent,i=e.id,a=Math.floor(this.Order/2)-1,o=r[a],p=r.slice(0,a),s=r.slice(1+a,this.Order-1),h=t.slice(0,a),f=t.slice(a,this.Order),d=new node_1.BNode,u=new node_1.BNode;if(d.keys=p,u.keys=s,l||(d.isLeaf=!1,u.isLeaf=!1),d.children=h,u.children=f,null===n){var g=new node_1.BNode;return(this.root=g).isLeaf=!1,g.keys=[o],g.children=[d,u],d.parent=g,void(u.parent=g)}for(var y=0,_=0;_<n.children.length;_++)if(n.children[_].id===i){y=_;break}d.parent=n,(u.parent=n).keys=n.keys.splice(y,0,o),n.children=n.children.splice(y,1,d,u),this.split(n)}},e.prototype.delete=function(e,t){},e}();exports.BTree=BTree;